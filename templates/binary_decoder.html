<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binary Decoder - Steganography</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div class="container mx-auto px-4 py-12 max-w-6xl">
        <nav class="mb-6">
            <ol class="flex text-sm text-gray-600">
                <li><a href="{{ url_for('index') }}" class="text-blue-600 hover:text-blue-800">Home</a></li>
                <li class="mx-2">/</li>
                <li class="text-gray-800">Binary Decoder</li>
            </ol>
        </nav>

        <h1 class="text-3xl font-bold text-gray-800 mb-6">Binary Decoder</h1>
        
        {% with messages = get_flashed_messages() %}
          {% if messages %}
            {% for message in messages %}
              <div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-6" role="alert">
                <p>{{ message }}</p>
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}
        
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <div class="p-6">
                <form action="{{ url_for('binary_decode') }}" method="post">
                    <div class="mb-6">
                        <label for="binary_input" class="block text-gray-700 text-sm font-bold mb-2">Binary Input:</label>
                        <textarea class="w-full text-gray-700 border border-gray-300 rounded py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono" 
                                  id="binary_input" name="binary_input" rows="8" placeholder="Enter binary data (0s and 1s, spaces allowed)">{{ binary_input if binary_input else '' }}</textarea>
                        <p class="text-gray-600 text-xs mt-1">Enter binary data (0s and 1s, spaces allowed)</p>
                    </div>
                    
                    <div class="flex items-center mb-4">
                        <input type="checkbox" id="try_multiple_encodings" name="try_multiple_encodings" class="mr-2" checked>
                        <label for="try_multiple_encodings" class="text-gray-700 text-sm">Try multiple text encodings (UTF-8, Latin-1, etc.)</label>
                    </div>
                    
                    <div class="text-center">
                        <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-8 rounded-md transition duration-300">
                            Decode Binary
                        </button>
                        <button type="button" id="clear-btn" class="ml-4 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-8 rounded-md transition duration-300">
                            Clear
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        {% if decoded_text %}
        <div class="mt-8">
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <div class="border-b px-6 py-3">
                    <h5 class="font-medium text-lg text-gray-800">Decoded Result</h5>
                </div>
                <div class="p-6">
                    <div class="border bg-gray-50 p-4 rounded-md">
                        <pre id="decoded-content" class="whitespace-pre-wrap break-words text-gray-700 font-mono">{{ decoded_text }}</pre>
                    </div>
                    <div class="flex gap-2 mt-4">
                        <button onclick="copyText()" 
                               class="text-sm py-1 px-3 border border-gray-300 rounded bg-white hover:bg-gray-100 text-gray-700 transition duration-200">
                            Copy to Clipboard
                        </button>
                        <button onclick="showHex()" 
                               class="text-sm py-1 px-3 border border-gray-300 rounded bg-white hover:bg-gray-100 text-gray-700 transition duration-200">
                            Show Hex
                        </button>
                    </div>
                    
                    <div id="hex-view" class="mt-4 hidden border bg-gray-50 p-4 rounded-md">
                        <h6 class="font-medium text-sm text-gray-700 mb-2">Hexadecimal Representation:</h6>
                        <div id="hex-content" class="text-xs font-mono break-all text-gray-600"></div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
        
        <div class="mt-8 bg-blue-50 border border-blue-200 rounded p-4">
            <h3 class="font-medium text-blue-800 mb-2">About Binary Decoding</h3>
            <p class="text-sm text-blue-700">
                This tool helps you convert binary data to readable text. It supports various text encodings and
                attempts to handle corrupted binary data. You can use this to decode binary messages or test
                steganography outputs.
            </p>
        </div>
    </div>
    
    <footer class="bg-gray-100 py-4 mt-10">
        <div class="container mx-auto text-center">
            <p class="text-gray-600 text-sm">Transform Domain Steganography Tool</p>
        </div>
    </footer>
    
    <script>
        document.getElementById('clear-btn').addEventListener('click', function() {
            document.getElementById('binary_input').value = '';
        });
        
        function copyText() {
            const content = document.getElementById('decoded-content').textContent;
            navigator.clipboard.writeText(content).then(() => {
                alert('Text copied to clipboard!');
            }, (err) => {
                console.error('Could not copy text: ', err);
            });
        }
        
        function showHex() {
            const text = document.getElementById('decoded-content').textContent;
            const hexView = document.getElementById('hex-view');
            const hexContent = document.getElementById('hex-content');
            
            hexView.classList.toggle('hidden');
            
            if (!hexView.classList.contains('hidden')) {
                if (text.length > 0) {
                    let hexStr = '';
                    const encoder = new TextEncoder();
                    const bytes = encoder.encode(text);
                    
                    for (let i = 0; i < bytes.length; i++) {
                        const hex = bytes[i].toString(16).padStart(2, '0').toUpperCase();
                        hexStr += hex + ' ';
                        if ((i + 1) % 16 === 0) hexStr += '\n';
                    }
                    hexContent.textContent = hexStr;
                } else {
                    hexContent.textContent = "No text to convert to hexadecimal.";
                }
            }
        }
    </script>
</body>
</html>
